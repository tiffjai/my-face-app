(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4265)}])},4265:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return pages}});var a=t(5893),n=t(9),l=t(202),s=t(7294),o=t(9279),i=t(512),d=t(8388);function cn(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,d.m6)((0,i.W)(r))}let c=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});c.displayName="Card";let u=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:cn("flex flex-col space-y-1.5 p-6",t),...n})});u.displayName="CardHeader";let m=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("h3",{ref:r,className:cn("text-2xl font-semibold leading-none tracking-tight",t),...n})});m.displayName="CardTitle";let f=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("p",{ref:r,className:cn("text-sm text-muted-foreground",t),...n})});f.displayName="CardDescription";let h=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:cn("p-6 pt-0",t),...n})});h.displayName="CardContent";let g=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:cn("flex items-center p-6 pt-0",t),...n})});g.displayName="CardFooter";var x=t(2003);let p=(0,x.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),v=s.forwardRef((e,r)=>{let{className:t,variant:n,...l}=e;return(0,a.jsx)("div",{ref:r,role:"alert",className:cn(p({variant:n}),t),...l})});v.displayName="Alert";let w=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("h5",{ref:r,className:cn("mb-1 font-medium leading-none tracking-tight",t),...n})});w.displayName="AlertTitle";let b=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:cn("text-sm [&_p]:leading-relaxed",t),...n})});b.displayName="AlertDescription";let y=s.forwardRef((e,r)=>{let{className:t,type:n,...l}=e;return(0,a.jsx)("input",{type:n,className:cn("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...l})});y.displayName="Input";var N=t(8426);let j=(0,x.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),E=s.forwardRef((e,r)=>{let{className:t,variant:n,size:l,asChild:s=!1,...o}=e,i=s?N.g7:"button";return(0,a.jsx)(i,{className:cn(j({variant:n,size:l,className:t})),ref:r,...o})});E.displayName="Button";var components_UploadImage=e=>{let{setImage:r}=e,[t,n]=(0,s.useState)(null),[l,i]=(0,s.useState)(!1),[d,g]=(0,s.useState)(null),[x,p]=(0,s.useState)(null);(0,s.useEffect)(()=>{let initHuman=async()=>{let e=new o.p2({backend:"webgl",modelBasePath:"https://cdn.jsdelivr.net/npm/@vladmandic/human/models/",face:{enabled:!0}});await e.load(),p(e)};initHuman()},[]);let handleImageChange=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){i(!0),g(null);try{let e=new FileReader,t=await new Promise((r,t)=>{e.onload=e=>{var a;(null===(a=e.target)||void 0===a?void 0:a.result)?r(e.target.result):t(Error("Failed to read file"))},e.onerror=()=>t(e.error),e.readAsDataURL(a)});if(!x)throw Error("Face detection not initialized");let l=new Image;await new Promise((e,r)=>{l.onload=e,l.onerror=r,l.src=t});let s=await x.detect(l);if(!s.face||0===s.face.length)throw Error("No face detected");n(t),r(t)}catch(e){console.error("Error processing image:",e),g(e.message||"Failed to process image")}finally{i(!1)}}};return(0,a.jsxs)(c,{className:"bg-white/80 backdrop-blur-sm hover:shadow-lg transition-shadow duration-300 max-h-[calc(100vh-2rem)] overflow-y-auto",children:[(0,a.jsxs)(u,{children:[(0,a.jsx)(m,{children:"Upload Portrait"}),(0,a.jsx)(f,{children:"Select an image to begin the transformation"})]}),(0,a.jsxs)(h,{children:[(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-32 cursor-pointer group",children:[(0,a.jsx)(y,{type:"file",onChange:handleImageChange,accept:"image/*",className:"hidden",id:"image-upload"}),(0,a.jsxs)("label",{htmlFor:"image-upload",className:"w-full h-full border-2 border-dashed rounded-lg flex flex-col items-center justify-center bg-background hover:bg-accent/5 transition-colors duration-300 cursor-pointer",children:[(0,a.jsx)("svg",{className:"w-8 h-8 text-muted-foreground mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Drag and drop your image here or"}),(0,a.jsx)(E,{variant:"secondary",size:"sm",className:"text-xs",children:"Choose File"})]})]})}),t&&(0,a.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"text-sm font-medium",children:"Original"}),(0,a.jsx)("div",{className:"relative rounded-lg overflow-hidden bg-accent/20 h-[300px]",children:(0,a.jsx)("img",{src:t,alt:"Original Image",className:"w-full h-full object-contain"})})]}),d&&"No face detected"!==d&&(0,a.jsx)(v,{variant:"destructive",className:"mt-4",children:(0,a.jsx)(b,{children:d})})]})]})]})},F=t(7483);let k=s.forwardRef((e,r)=>{let{className:t,value:n,...l}=e;return(0,a.jsx)(F.fC,{ref:r,className:cn("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...l,children:(0,a.jsx)(F.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});k.displayName=F.fC.displayName;var C=t(6680);let I=s.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsxs)(C.fC,{ref:r,className:cn("relative flex w-full touch-none select-none items-center",t),...n,children:[(0,a.jsx)(C.fQ,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:(0,a.jsx)(C.e6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(C.bU,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});I.displayName=C.fC.displayName;var components_ImageModifier=e=>{let{image:r}=e,[t,n]=(0,s.useState)(1),[l,i]=(0,s.useState)(1),[d,g]=(0,s.useState)(null),[x,p]=(0,s.useState)(null),[w,y]=(0,s.useState)(!1),[N,j]=(0,s.useState)(null);(0,s.useEffect)(()=>{let initHuman=async()=>{let e=new o.p2({backend:"webgl",modelBasePath:"https://cdn.jsdelivr.net/npm/@vladmandic/human/models/",face:{enabled:!0}});await e.load(),j(e)};initHuman()},[]);let getBoundingBox=e=>{if(!e||0===e.length)throw Error("No points provided for bounding box calculation");let r=e.filter(e=>e&&Array.isArray(e)&&e.length>=2&&e.every(e=>Number.isFinite(e)&&e>=0));if(0===r.length)throw Error("No valid points found for bounding box calculation");let t=1/0,a=1/0,n=-1/0,l=-1/0;r.forEach(e=>{let[r,s]=e;t=Math.min(t,r),a=Math.min(a,s),n=Math.max(n,r),l=Math.max(l,s)});let s=Math.max(2,Math.min((n-t)*.1,(l-a)*.1)),o=Math.max(0,t-s),i=Math.max(0,a-s),d=Math.max(1,n-t+2*s),c=Math.max(1,l-a+2*s);return[o,i,d,c]},enlargeFeature=(e,r,t)=>{try{let a;if(!r||0===r.length)throw Error("No feature points provided");if(!Number.isFinite(t)||t<=0)throw Error("Invalid scale value: ".concat(t));let[n,l,s,o]=getBoundingBox(r),i=e.canvas.width,d=e.canvas.height;if(n<0||l<0||n+s>i||l+o>d)throw Error("Feature bounds exceed canvas dimensions");let c=Math.round(n),u=Math.round(l),m=Math.round(s),f=Math.round(o);try{a=e.getImageData(c,u,m,f)}catch(e){throw Error("Failed to get image data: ".concat(e instanceof Error?e.message:"Unknown error"))}let h=document.createElement("canvas"),g=h.getContext("2d");if(!g)throw Error("Failed to create temporary canvas context");h.width=m,h.height=f,g.putImageData(a,0,0);let x=s*t,p=o*t,v=n-s*(t-1)/2,w=l-o*(t-1)/2;if(v<0||w<0||v+x>i||w+p>d)throw Error("Scaled feature would exceed canvas bounds");e.clearRect(n,l,s,o),e.drawImage(h,v,w,x,p)}catch(e){throw console.error("Error in enlargeFeature:",e),e}},shrinkFace=(e,r,t)=>{try{if(!r||0===r.length)throw Error("No jawline points provided");if(!Number.isFinite(t)||t<=0)throw Error("Invalid scale value: ".concat(t));let a=e.canvas.width,n=e.canvas.height,l=a/2,s=n/2,o=r.map(e=>{if(!Array.isArray(e)||e.length<2)throw Error("Invalid jawline point detected");let[r,o]=e,i=r*t+(1-t)*l,d=o*t+(1-t)*s;if(i<0||i>a||d<0||d>n)throw Error("Transformed point would exceed canvas bounds");return[i,d]});o.forEach((e,t)=>{r[t]=e}),"filter"in e?e.filter="blur(2px)":console.warn("Canvas filter not supported in this browser"),e.globalAlpha=.9}catch(e){throw console.error("Error in shrinkFace:",e),e}},getFeaturePoints=(e,r,t)=>{let a=r.map(r=>e[r]),n=a.map((e,r)=>{if(Array.isArray(e)&&e.length>=2){let a=Number(e[0]),n=Number(e[1]);if(Number.isFinite(a)&&Number.isFinite(n)&&a>=0&&n>=0)return[a,n];console.error("".concat(t," point ").concat(r," has non-finite or negative coordinates:"),e)}else console.error("".concat(t," point ").concat(r," is invalid:"),e);return null}).filter(e=>null!==e);return console.log("".concat(t," validation report:"),{requested:r.length,validPoints:n.length,points:n}),n},modifyImage=async(e,t)=>{if(!N){p("Face detection model not loaded");return}y(!0),p(null);try{let a=new Image;a.src=r,await new Promise(e=>{a.onload=e});let n=document.createElement("canvas");n.width=a.width,n.height=a.height;let l=n.getContext("2d");if(!l)throw Error("Could not get canvas context");l.drawImage(a,0,0);let s=await N.detect(a);if(!s.face||0===s.face.length)throw Error("No face detected in the image. Please ensure your face is clearly visible.");s.face.length>1&&console.warn("Multiple faces detected, using the first face");let o=s.face[0];if(!o.score||o.score<.7)throw Error("Face detection confidence is too low. Please ensure better lighting and face visibility.");if(!o.mesh)throw Error("No facial landmarks detected. Please ensure your face is clearly visible and not obscured.");if(!Array.isArray(o.mesh))throw Error("Invalid facial mesh structure detected.");if(o.mesh.length<468)throw console.error("Unexpected number of mesh points:",{expected:468,found:o.mesh.length,meshData:o.mesh}),Error("Incomplete facial feature detection. Please ensure your face is well-lit and directly facing the camera.");let i=Array.from({length:17},(e,r)=>r),d=getFeaturePoints(o.mesh,[33,7,163,144,145,153,154,155,133],"left eye"),c=getFeaturePoints(o.mesh,[263,249,390,373,374,380,381,382,362],"right eye"),u=getFeaturePoints(o.mesh,i,"jawline");if(0===d.length)throw Error("Left eye landmarks not properly detected.");if(0===c.length)throw Error("Right eye landmarks not properly detected.");if(0===u.length)throw Error("Jawline landmarks not properly detected.");console.log("Enlarging left eye"),enlargeFeature(l,d,e),console.log("Enlarging right eye"),enlargeFeature(l,c,e),console.log("Shrinking face via jawline"),shrinkFace(l,u,t);let m=n.toDataURL("image/jpeg");g(m)}catch(e){console.error("Error modifying image:",e),p(e.message||"Failed to modify image"),g(null)}finally{y(!1)}};return(0,a.jsxs)(c,{className:"w-full max-w-3xl mx-auto bg-white/80 backdrop-blur-sm max-h-[calc(100vh-2rem)] overflow-y-auto",children:[(0,a.jsxs)(u,{children:[(0,a.jsx)(m,{children:"Adjust Features"}),(0,a.jsx)(f,{children:"Fine-tune facial features with precision"})]}),(0,a.jsxs)(h,{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("label",{className:"text-sm font-medium",children:"Eye Size"}),(0,a.jsx)(I,{min:.5,max:2,step:.1,value:[t],onValueChange:e=>{let[r]=e;n(r),modifyImage(r,l)},className:"w-full"}),(0,a.jsx)("label",{className:"text-sm font-medium",children:"Face Size"}),(0,a.jsx)(I,{min:.5,max:2,step:.1,value:[l],onValueChange:e=>{let[r]=e;i(r),modifyImage(t,r)},className:"w-full"})]}),w&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[(0,a.jsx)(k,{value:33,className:"w-[60%]"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Processing changes..."})]}),x&&(0,a.jsx)(v,{variant:"destructive",children:(0,a.jsx)(b,{children:x})}),d&&!w&&(0,a.jsx)("div",{className:"rounded-lg overflow-hidden bg-accent/20 h-[300px]",children:(0,a.jsx)("img",{src:d,alt:"Modified",className:"w-full h-full object-contain"})})]})]})};let M=new n.S;var pages=()=>{let[e,r]=(0,s.useState)(null);return(0,a.jsx)(l.aH,{client:M,children:(0,a.jsx)("div",{className:"h-screen overflow-hidden bg-gradient-to-br from-accent via-background to-accent/50",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-6 py-8 h-full overflow-y-auto",children:[(0,a.jsxs)("div",{className:"text-center mb-16",children:[(0,a.jsxs)("h1",{className:"text-4xl md:text-5xl font-light tracking-tight text-primary mb-6",children:["Face ",(0,a.jsx)("span",{className:"font-normal bg-clip-text text-transparent bg-gradient-to-r from-primary via-primary/80 to-primary",children:"Modifier"})]}),(0,a.jsx)("p",{className:"text-muted-foreground text-lg md:text-xl font-light max-w-2xl mx-auto leading-relaxed",children:"Transform your portraits with precision and elegance. Experience professional-grade facial modifications powered by advanced AI."})]}),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsx)(components_UploadImage,{setImage:r}),e&&(0,a.jsx)("div",{className:"transition-all duration-700 ease-in-out transform",children:(0,a.jsx)(components_ImageModifier,{image:e})})]})]})})})}}},function(e){e.O(0,[950,782,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);